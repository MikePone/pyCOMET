# pyCOMET
Python implementation of the COMET subtyping tool. The orginal implementation of COMET algorithm can be found in Struck *et al.* paper [here](https://www.ncbi.nlm.nih.gov/pubmed/25120265).

## Training

Use `predictType_ppmd_train.py` to build the PPMD models for subtyping from a refernce sequence file in FASTA format. The usage is given below:

```
usage: predictType_ppmd_train.py [-h] -r REFERENCE -c CONTEXT -m MODELFILE

Creates a PPMD model from a set of reference sequences given a fixed context size for subtype classification

optional arguments:
  -h, --help            show this help message and exit
  -r REFERENCE, --reference REFERENCE
                        Reference sequence file in FASTA format for creating PPMD model
  -c CONTEXT, --context CONTEXT
                        Context size for PPMD model (default: 8)
  -m MODELFILE, --modelFile MODELFILE
                        Output file to save the PPMD model
```
The sequence headers of the reference FASTA file must have the following format:
```
>subtype.rest_of_the_header
```

## Subtyping

Query sequences in a FASTA file can be used for subtyping using `predictType_ppmd_22xi16.py`. This script requires a PPMD model description file generated by `predictType_ppmd_train.py`. The usage line is given below:

```
usage: predictType_ppmd_22xi16.py [-h] -q QUERY [-c CONTEXT] -m MODELFILE

Predicts subtype of a sequence based on PPMD models trained using reference sequences

optional arguments:
  -h, --help            show this help message and exit
  -q QUERY, --query QUERY
                        Query sequence file in FASTA format for subtype classification
  -c CONTEXT, --context CONTEXT
                        Context size for PPMD model (default: 8)
  -m MODELFILE, --modelFile MODELFILE
                        PPMD model file for reference sequences
```


